# FDTDシミュレーションにおける電流源と放射電場の解析的関係に関する調査報告書

**参考資料**: https://gemini.google.com/share/e8331c2afab7

## 第1章 マクスウェル方程式の基礎：電流源から波動方程式へ

本章では、FDTDシミュレーションの物理的基盤をなす基本法則を確立します。古典電磁気学の礎であるマクスウェル方程式から出発し、電流源が電場および磁場をどのように生成するかを論じます。最終的な目標は、電場と電流の時間微分の間に存在する直接的な数学的関係を初めて示す、非斉次波動方程式を導出することです。
### 1.1 マクスウェル方程式における電流密度の役割

古典電磁気学のすべての現象は、一組の連立偏微分方程式、すなわちマクスウェル方程式によって記述されます。一般的な媒質中における微分形のマクスウェル方程式は、電場ベクトルを$\vec{E}$、磁場ベクトルを$\vec{H}$、電束密度を$\vec{D}$、磁束密度を$\vec{B}$、電荷密度を$\rho$、電流密度を$\vec{J}$として、以下のように与えられます。

**ファラデーの電磁誘導の法則:**

$$\nabla \times \vec{E} = -\frac{\partial \vec{B}}{\partial t}$$

この式は、時間的に変動する磁場が渦を巻くような電場を誘起することを示しています。

**アンペール・マクスウェルの法則:**

$$\nabla \times \vec{H} = \vec{J} + \frac{\partial \vec{D}}{\partial t}$$

この法則は、磁場の源が2種類存在することを示しています。一つは伝導電流（電荷の物理的な移動）を表す$\vec{J}$であり、もう一つはマクスウェルによって導入された変位電流$\frac{\partial \vec{D}}{\partial t}$（時間的に変動する電場）です。この変位電流項の導入により、電流が存在しない空間でも電磁波が伝搬できることが理論的に示されました。

**電場に関するガウスの法則:**

$$\nabla \cdot \vec{D} = \rho$$

この式は、電束線の発生源が電荷であることを示しています 2。

**磁場に関するガウスの法則:**

$$\nabla \cdot \vec{B} = 0$$

この式は、磁気単極子（モノポール）が存在しないこと、すなわち磁力線には発生源も消滅点もなく、必ず閉ループを形成することを示しています 1。

これらの法則の中で、電流源$\vec{J}$と電磁場の関係を理解する上で特に重要なのは、アンペール・マクスウェルの法則とファラデーの法則です。アンペール・マクスウェルの法則は、電流$\vec{J}$が直接的に磁場$\vec{H}$を生成することを示しています。そして、ファラデーの法則によれば、そのようにして生成された磁場が時間的に変動する場合（すなわち、電流が時間的に変動する場合）、今度はその磁場が電場$\vec{E}$を誘起します。

このことから、電流源と電場の間には、$\vec{J}(t) \rightarrow \vec{B}(t) \rightarrow \vec{E}(t)$という因果関係の連鎖が存在することがわかります。

### 1.2 電場に関する非斉次波動方程式の導出

前節で述べた因果関係の連鎖は物理的に直感的ですが、より直接的な数学的関係を明らかにするために、マクスウェル方程式から磁場変数を消去し、電場$\vec{E}$とその源である$\vec{J}$のみを含む単一の方程式を導出します。この手続きにより、電場に関する非斉次波動方程式が得られます。

導出はファラデーの法則の両辺の回転（curl）を取ることから始まります。

$$ \nabla \times (\nabla \times \vec{E}) = -\nabla \times \left(\frac{\partial \vec{B}}{\partial t}\right) $$

時間微分と空間微分は交換可能であるため、右辺は$-\frac{\partial}{\partial t}(\nabla \times \vec{B})$となります。ここで、ベクトル解析の恒等式 $\nabla \times (\nabla \times \vec{E}) = \nabla(\nabla \cdot \vec{E}) - \nabla^2 \vec{E}$ を左辺に適用します [2, 8]。

$$ \nabla(\nabla \cdot \vec{E}) - \nabla^2 \vec{E} = -\frac{\partial}{\partial t}(\nabla \times \vec{B}) $$

次に、線形で等方的な媒質（誘電率$\varepsilon$、透磁率$\mu$、導電率$\sigma$）を仮定し、構成方程式$\vec{D} = \varepsilon \vec{E}$、$\vec{B} = \mu \vec{H}$、$\vec{J} = \sigma \vec{E}$（オームの法則）を適用します。アンペール・マクスウェルの法則は$\nabla \times \vec{B} = \mu \vec{J} + \mu \varepsilon \frac{\partial \vec{E}}{\partial t}$と書き換えられます。これを上式に代入すると、

$$ \nabla(\nabla \cdot \vec{E}) - \nabla^2 \vec{E} = -\frac{\partial}{\partial t}\left(\mu \vec{J} + \mu \varepsilon \frac{\partial \vec{E}}{\partial t}\right) $$

ここで、シミュレーションで扱うような、外部から印加される電流源$\vec{J}_{es}$が存在し、それ以外の領域では電荷が存在しない（$\rho = 0$）状況を考えます。ガウスの法則から$\nabla \cdot \vec{D} = 0$となり、$\nabla \cdot \vec{E} = 0$となります。これにより、上式の第一項は消去できます。また、媒質自体の導電率による電流（$\sigma \vec{E}$）と外部電流源$\vec{J}_{es}$を区別して$\vec{J} = \sigma \vec{E} + \vec{J}_{es}$とすると、最終的に電場に関する非斉次波動方程式が得られます 9。

$$ \nabla^2 \vec{E} - \mu \varepsilon \frac{\partial^2 \vec{E}}{\partial t^2} - \mu \sigma \frac{\partial \vec{E}}{\partial t} = \mu \frac{\partial \vec{J}_{es}}{\partial t} $$

### 1.3 最初の洞察：強制項と電流の時間微分

導出された波動方程式は、電磁波の伝搬を記述する上で極めて重要な情報を含んでいます。式の左辺は、空間的な変化（$\nabla^2 \vec{E}$）、時間的な変化（$\frac{\partial^2 \vec{E}}{\partial t^2}$）、そして媒質の損失による減衰（$\frac{\partial \vec{E}}{\partial t}$）を記述する波動演算子です。一方、右辺の$\mu \frac{\partial \vec{J}_{es}}{\partial t}$は、この波動現象を引き起こす「強制項」または「駆動項」として機能します 9。

この結果は、ご質問に対する最初の、そして最も根本的な答えを与えてくれます。電磁波としての電場を生成する直接の源は、電流$\vec{J}$そのものではなく、その時間的な変化率、すなわち時間微分$\frac{\partial \vec{J}}{\partial t}$なのです。

この事実は、直流電流（時間変化しない電流）が静磁場を生成するものの電磁波を放射しないのに対し、電磁波の放射には必ず電荷の加速度運動（時間変化する電流）が必要であるという物理的観察と完全に一致します 10。

したがって、「電流波形を時間微分すると電場波形が得られる」という理解は、この波動方程式のレベルでは本質的に正しいと言えます。しかし、この方程式は微分方程式であり、その解（すなわち観測される電場波形）は、境界条件や伝搬経路に依存して複雑な形をとります。より具体的な解析的関係を導出するためには、次章で導入するポテンシャルの概念を用いた、より洗練された解法が必要となります。

## 第2章 電磁ポテンシャルによる一般解

前章で導出した波動方程式は、電場と電流の時間微分の間の基本的な関係を明らかにしましたが、複雑な形状の電流源に対してこの微分方程式を直接解くことは一般的に困難です。本章では、電磁場を直接求める代わりに、より扱いやすい中間的な量である「電磁ポテンシャル」を導入する標準的な解析手法について解説します。このアプローチは問題を単純化し、任意の電流源に対する一般的な積分形式の解を与えます。この枠組みは、次章で詳述する遠方界の導出に不可欠です。

### 2.1 磁気ベクトルポテンシャル($\vec{A}$)と電位スカラーポテンシャル($\phi$)の導入

マクスウェル方程式は、ポテンシャルを導入することでより簡潔に扱うことができます。まず、磁場に関するガウスの法則$\nabla \cdot \vec{B} = 0$は、磁場$\vec{B}$が何らかのベクトル場の回転として表現できることを示唆しています。なぜなら、任意のベクトル場$\vec{A}$に対して、恒等的に$\nabla \cdot (\nabla \times \vec{A}) = 0$が成り立つからです。そこで、磁気ベクトルポテンシャル$\vec{A}$を以下のように定義します 10。

$$\vec{B} = \nabla \times \vec{A}$$

この定義は、自動的に磁場に関するガウスの法則を満たします。次に、この$\vec{B}$の定義をファラデーの電磁誘導の法則$\nabla \times \vec{E} = -\frac{\partial \vec{B}}{\partial t}$に代入します。

$$ \nabla \times \vec{E} = -\frac{\partial}{\partial t}(\nabla \times \vec{A}) = -\nabla \times \left(\frac{\partial \vec{A}}{\partial t}\right) $$

項を移項すると、

$$ \nabla \times \left(\vec{E} + \frac{\partial \vec{A}}{\partial t}\right) = 0 $$

この式は、ベクトル場$\vec{E} + \frac{\partial \vec{A}}{\partial t}$の回転がゼロであることを意味します。回転がゼロのベクトル場は、任意のスカラー場の勾配（gradient）として表現できます。そこで、電位スカラーポテンシャル$\phi$を導入し、次のように定義します 10。

$$\vec{E} + \frac{\partial \vec{A}}{\partial t} = -\nabla \phi$$

これらのポテンシャルを用いることで、4つのマクスウェル方程式のうち2つ（ファラデーの法則と磁場に関するガウスの法則）が自動的に満たされるため、問題の解析が大幅に簡略化されます。

### 2.2 電場の分解：$\vec{E} = -\frac{\partial \vec{A}}{\partial t} - \nabla \phi$

前節の定義から、電場$\vec{E}$はポテンシャルを用いて以下のように表現できます。

$$\vec{E} = -\frac{\partial \vec{A}}{\partial t} - \nabla \phi$$

この式は、ポテンシャルを用いたアプローチの根幹をなすものであり、電場が物理的に異なる二つの成分の重ね合わせであることを明確に示しています 10。

**誘導成分** ($-\frac{\partial \vec{A}}{\partial t}$): この項は、ベクトルポテンシャル$\vec{A}$の時間変化に直接起因する電場成分です。後述するように、$\vec{A}$は電流密度$\vec{J}$によって生成されるため、この項は時間変動する電流が引き起こす誘導電場に対応します。

**静電的成分** ($-\nabla \phi$): この項は、スカラーポテンシャル$\phi$の空間的な勾配に起因する電場成分です。$\phi$は電荷密度$\rho$によって生成されるため、この項は電荷分布が作る静電場に類似した成分に対応します。

この電場の分解は、ご質問の「電流波形を時間微分すると電場波形が得られる」という関係が普遍的に成り立つわけではないことを示唆しています。この関係は主に誘導成分に由来するものですが、全体の電場には電荷に起因する静電的成分も含まれるため、その寄与を考慮する必要があります。この二つの成分の相対的な重要性が、観測点が波源から近い「近傍界」か遠い「遠方界」かによって劇的に変化することが、次章の議論の鍵となります。

### 2.3 遅延ポテンシャル解：有限伝搬速度の考慮

ポテンシャル$\vec{A}$と$\phi$を決定するために、残りのマクスウェル方程式（アンペール・マクスウェルの法則と電場に関するガウスの法則）にポテンシャルの定義を代入します。この過程で、ポテンシャルの不定性を解消するためのゲージ条件を選択する必要があります。一般的に用いられるローレンツゲージ条件 $\nabla \cdot \vec{A} + \frac{1}{c^2}\frac{\partial \phi}{\partial t} = 0$ (ここで $c = 1/\sqrt{\mu_0 \varepsilon_0}$) を採用すると、$\vec{A}$と$\phi$に関する方程式は、それぞれ独立した非斉次波動方程式に分離されます [11, 12]。

$$\nabla^2 \vec{A} - \frac{1}{c^2} \frac{\partial^2 \vec{A}}{\partial t^2} = -\mu_0 \vec{J}$$

$$\nabla^2 \phi - \frac{1}{c^2} \frac{\partial^2 \phi}{\partial t^2} = -\frac{\rho}{\varepsilon_0}$$

これらの波動方程式の解は、グリーン関数法を用いて求めることができます。電磁場の伝搬速度が有限（光速 $c$）であるため、時刻$t$に観測点$\vec{r}$で観測されるポテンシャルは、波源の位置$\vec{r}'$から光が伝搬するのに要する時間$R/c$（ここで$R = |\vec{r} - \vec{r}'|$）だけ過去の、すなわち時刻$t' = t - R/c$における波源の状態によって決定されます。この時刻$t'$を「遅延時間（retarded time）」と呼びます 12。

この遅延の効果を考慮したポテンシャルの解は「遅延ポテンシャル」として知られ、以下の積分形式で与えられます 12。

$$\vec{A}(\vec{r}, t) = \frac{\mu_0}{4\pi} \int \frac{\vec{J}(\vec{r}', t - R/c)}{R} dV'$$

$$\phi(\vec{r}, t) = \frac{1}{4\pi \varepsilon_0} \int \frac{\rho(\vec{r}', t - R/c)}{R} dV'$$

これらの積分は、波源が存在する全空間にわたって行われます。これらは、与えられた電流分布$\vec{J}$と電荷分布$\rho$からポテンシャルを計算するための、完全に一般的かつ厳密な解です。この遅延ポテンシャル解が、次章で電流と電場の具体的な関係を導出するための出発点となります。

## 第3章 微小電流源の放射遠方界

本章では、ご質問の中心である「電流波形を時間微分すると電場波形が得られる」という関係を厳密に導出します。そのために、最も基本的で単純な放射源である「ヘルツダイポール」をモデルとして用い、波源から十分に離れた「遠方界」における電磁場を解析します。この遠方界近似を適用することにより、前章で得られた一般的な遅延ポテンシャル解が劇的に簡略化され、求める関係が明確に現れます。

### 3.1 ヘルツダイポール：基本的な放射モデル

より複雑なアンテナや電流源からの放射を理解するための基礎として、まず微小な電流要素からの放射を考えます。このモデルは「ヘルツダイポール」または「微小ダイポール」と呼ばれ、長さが放射電磁波の波長に比べて無視できるほど短い（$dl \ll \lambda$）、直線状の導線を流れる一様な時間変動電流$I(t)$として定義されます 15。

数学的には、この電流源は原点に置かれ、$z$軸方向を向いている点状の電流密度として、ディラックのデルタ関数$\delta(\vec{r}')$を用いて次のように表現できます [16, 17]。

$$\vec{J}(\vec{r}', t) = I(t) dl \, \delta(\vec{r}') \, \hat{z}$$

ここで、$\hat{z}$は$z$軸方向の単位ベクトルです。この単純なモデルは、任意の形状のアンテナを微小なヘルツダイポールの集まりとして表現し、その放射を重ね合わせることで解析するための基本要素となります 15。

### 3.2 遠方界近似：遅延ポテンシャルの簡略化

遠方界（またはフラウンホーファー領域）とは、観測点までの距離$r$が、波源の大きさ$dl$および放射波長$\lambda$の両方に比べて非常に大きい領域として定義されます（$r \gg dl$ かつ $r \gg \lambda$）18。GPR（地中レーダー）探査のように、送信アンテナからターゲットや受信アンテナまでの距離が通常、波長に比べて十分大きい状況では、この遠方界近似が非常に有効です。

この近似を第2.3節で示した遅延ポテンシャルの積分に適用します。

$$\vec{A}(\vec{r}, t) = \frac{\mu_0}{4\pi} \int \frac{\vec{J}(\vec{r}', t - R/c)}{R} dV'$$

ここで、$R = |\vec{r} - \vec{r}'|$です。遠方界では、以下の2つの近似が成り立ちます。

**振幅項の近似**: 分母の$R$は、波源の内部での$\vec{r}'$の変化に対してほとんど変化しないため、$R \approx r$と近似できます。

**位相項（遅延時間）の近似**: 分子の$\vec{J}$の引数に含まれる$R$は、位相に大きく影響するため、より精密な近似が必要です。$R = \sqrt{(\vec{r}-\vec{r}') \cdot (\vec{r}-\vec{r}')} \approx r - \vec{r}' \cdot \hat{r}$と近似されます 22。

ヘルツダイポールの場合、波源は原点に集中しているため（$\vec{r}' \approx 0$）、これらの近似はさらに単純になります。ベクトルポテンシャル$\vec{A}$は、

$$ \vec{A}(\vec{r}, t) \approx \frac{\mu_0}{4\pi r} \int I(t - r/c) dl \, \delta(\vec{r}') \, \hat{z} \, dV' $$

となり、デルタ関数の性質から積分は即座に実行でき、最終的に以下の非常に単純な形になります [23]。

$$ \vec{A}(\vec{r}, t) \approx \frac{\mu_0 dl}{4\pi r} I(t - r/c) \, \hat{z} $$

### 3.3 最終的な導出：$\vec{E}$と$\frac{dI}{dt}$の比例関係の証明

これで、遠方界における電場$\vec{E}$を計算する準備が整いました。出発点は、第2.2節で確立した関係式$\vec{E} = -\frac{\partial \vec{A}}{\partial t} - \nabla \phi$です。

まず、主要な寄与を担う第一項$-\frac{\partial \vec{A}}{\partial t}$を計算します。前節で得られた遠方界での$\vec{A}$の表式を時間で偏微分します。ここで、遅延時間$t' = t - r/c$を介した連鎖律を用いると、

$$ \frac{\partial}{\partial t} I(t - r/c) = \frac{dI(t')}{dt'} \frac{\partial t'}{\partial t} = \frac{dI(t')}{dt'} \times 1 $$

となるため、

$$ -\frac{\partial \vec{A}}{\partial t} \approx -\frac{\mu_0 dl}{4\pi r} \frac{dI(t - r/c)}{dt} \, \hat{z} $$

この項は電流の時間微分に比例し、距離に反比例して（$1/r$で）減衰することがわかります。

次に、第二項$-\nabla \phi$の寄与を評価します。遠方界では、この項もまた$1/r$で減衰する成分を持ち、その主要部分は$-\frac{\partial \vec{A}}{\partial t}$項と打ち消し合って、最終的な電場が伝搬方向（動径方向$\hat{r}$）に対して垂直になるように作用します [23]。

この計算を球座標系で行うと、最終的に放射される遠方界の電場は、動径方向成分を持たず、$\theta$方向成分のみを持つことが示されます。

$$ \vec{E}(\vec{r}, t) \approx \frac{\mu_0 dl \sin\theta}{4\pi r} \left[ \frac{dI(t - r/c)}{dt} \right] \hat{\theta} $$

この式こそが、ご質問に対する厳密な証明です。この結果は以下の重要な特徴を明確に示しています。

**微分関係**: 遠方放射電場$\vec{E}$の振幅は、波源電流$I(t)$の時間微分$\frac{dI}{dt}$に直接比例します。

**遅延時間**: 電場波形は、波源から観測点までの伝搬時間$r/c$だけ遅れた時刻の電流微分によって決まります。

**振幅減衰**: 電場の振幅は、距離$r$に反比例して減衰します（$E \propto 1/r$）。

**放射パターン**: 電場の強度は$\sin\theta$に比例します。これは、ダイポールの軸方向（$\theta=0, \pi$）には放射が無く、ダイポールに垂直な平面（$\theta=\pi/2$）で放射が最大になることを意味します。

### 3.4 全体像：放射界（遠方界）と反応界（近傍界）の対比

遠方界近似を用いずにヘルツダイポールの電磁場を厳密に計算すると、距離に関して異なる依存性を持つ項が現れます。具体的には、前節で導出した$1/r$で減衰する「放射界」の他に、$1/r^2$で減衰する「誘導界」と$1/r^3$で減衰する「静電界（準静電界）」が存在します 13。

**近傍界（反応界）**: 波源に非常に近い領域では、$1/r^3$や$1/r^2$の項が支配的です。これらの項は、電流$I(t)$やその時間積分（電荷$q(t)$）に関連しており、単純な微分関係にはなりません。物理的には、これらの近傍界成分はアンテナの周囲にエネルギーを蓄える「反応性」の場に対応し、遠方へは放射されません 18。

**遠方界（放射界）**: 波源から遠く離れると、$1/r^3$や$1/r^2$の項は急速に減衰して無視できるようになり、$1/r$の放射界成分のみが残ります。この放射界こそが、エネルギーを無限遠まで運び去る電磁波そのものです。

この対比から、ご質問の「電流の時間微分が電場になる」という関係は、遠方界においてのみ成立する近似的な、しかし非常に精度の高い真実であることが結論付けられます。遠方界近似は単なる数学的な簡略化ではなく、物理的に電磁場から放射成分だけを抽出する操作と見なすことができます。GPRシミュレーションでは、受信点は通常、送信点から数波長以上離れているため、観測される波形はこの遠方界の理論によって非常によく記述されます。

## 第4章 次元の影響：2次元と3次元の波動伝搬の比較

現在、2次元（2D）のFDTDシミュレーションを実施されているとのことですが、理論が3次元（3D）とどのように異なるのかというご質問は極めて重要です。本章では、この次元性の違いが波動伝搬に与える根本的な影響を詳述します。結論から言えば、前章で導出した遠方界における微分関係（$\vec{E} \propto \frac{dI}{dt}$）の基本的な性質は2Dでも維持されますが、波の伝わり方、特に振幅の減衰と波形の形状は3Dと2Dで本質的に異なります。

### 4.1 物理的な違い：円筒波（2D）と球面波（3D）

波動伝搬における最も基本的な次元性の違いは、波面の幾何学的形状に現れます。

**3次元（球面波）**: 3D空間（現実世界や3D FDTDシミュレーション）において、ヘルツダイポールのような点状の波源は、波を全方向に均等に放射します。その結果、波面は波源を中心とする球の形をとります。これを「球面波」と呼びます。波のエネルギーは、球の表面積（$A \propto r^2$）に比例して広がりながら伝搬します。このエネルギーの拡散は「球面拡散」として知られています 24。

**2次元（円筒波）**: 2DのFDTDシミュレーションでは、モデルは一つの次元（通常は$z$方向）に無限に一様であると仮定されます。したがって、シミュレーション内の波源は、物理的には点ではなく「無限に長い線状の波源」に相当します。このような線状の波源から放射される波の波面は、波源を中心とする円筒の形をとります。これを「円筒波」と呼びます。波のエネルギーは、円筒の側面積（$A \propto r$）に比例して広がります。これは「円筒拡散」と呼ばれます 24。

この幾何学的な拡散の仕方の違いが、2Dと3Dのシミュレーション結果に見られる物理的な差異の根源となります 24。

### 4.2 数学的根源：2Dと3Dのグリーン関数の比較

波動伝搬の物理的な違いは、波動方程式の基本解である「グリーン関数」の数学的な形式の違いに起因します。グリーン関数は、点状のインパルス的な波源に対する系の応答（インパルス応答）を記述するものであり、その形式が波の伝わり方を決定します 30。時間調和的な場（角周波数$\omega$、波数$k = \omega/c$）を考えると、波動方程式はヘルムホルツ方程式となります。

**3次元グリーン関数**: 3D空間におけるヘルムホルツ方程式 $(\nabla^2 + k^2)G = -\delta(\vec{r})$ の解は、外向きに伝搬する波を表すグリーン関数として、以下で与えられます 11。

$$G_{3D}(\vec{r}) = \frac{e^{ik|\vec{r}|}}{4\pi|\vec{r}|}$$

この関数は球面波の伝搬を記述しています。

**2次元グリーン関数**: 2D空間におけるヘルムホルツ方程式 $(\nabla^2 + k^2)G = -\delta(\vec{\rho})$ の解は、以下で与えられます 32。

$$G_{2D}(\vec{\rho}) = \frac{i}{4} H_0^{(1)}(k|\vec{\rho}|)$$

ここで、$H_0^{(1)}$は第一種ゼロ次のハンケル関数です。この関数は円筒波の伝搬を記述しており、3Dのグリーン関数とは数学的な構造が全く異なります。

これらグリーン関数の形式の違いが、次節で述べる振幅減衰や波形進化の差異を直接的にもたらします。

### 4.3 振幅減衰と波形進化への影響

グリーン関数の違いは、シミュレーション結果に現れる二つの重要な違い、すなわち振幅の減衰率と波形の「尾引き」現象（テイリング）をもたらします。

#### 4.3.1 振幅の減衰

波の強度（単位面積当たりのパワー）は電場の振幅の2乗に比例します（$I \propto E^2$）。幾何学的拡散により、総エネルギーは保存されると仮定すると、強度は波面が広がる面積に反比例して減少します。

**3次元**: 強度は球面拡散により$I \propto 1/r^2$で減少します。したがって、電場の振幅は距離に反比例して減衰します：$\boldsymbol{E \propto 1/r}$ 19。

**2次元**: 強度は円筒拡散により$I \propto 1/r$で減少します。したがって、電場の振幅は距離の平方根に反比例して減衰します：$\boldsymbol{E \propto 1/\sqrt{r}}$ 24。

これは極めて重要な違いです。2Dシミュレーションでは、3Dの現実世界に比べて電磁波がはるかにゆっくりと減衰します。したがって、2Dシミュレーションで得られた振幅を3Dの測定値と直接比較する際には、この減衰則の違いを考慮した補正が必要になる場合があります。

#### 4.3.2 波形の尾引き（テイリング）

もう一つの、より捉えにくいが決定的な違いは、波形の時間的な進化です。

**3次元**: 3D空間（一般に奇数次元空間）では、ホイヘンスの原理が「強い形」で成り立ちます。これは、インパルス的な波源（例えば、非常に短いパルス）が発生させる波は、その場を通過した後には何も残さず、波形がクリーンに伝搬していくことを意味します。

**2次元**: 2D空間（一般に偶数次元空間）では、ホイヘンスの原理は「弱い形」でしか成り立ちません。2Dのグリーン関数は、インパルス的な入力に対して、主パルスの後にも長く続く「尾（テイル）」や「後続波（ウェイク）」を持つ応答を生成します。

この結果、2DのGPRシミュレーションでは、たとえ波源波形がクリーンなパルスであっても、伝搬するにつれて波形に尾引きが生じ、3Dシミュレーションや実際の測定結果と比較して、より多くの「リンギング」や「クラッター」が観測されることになります。この現象は、2D近似に内在する物理的な特性であり、シミュレーションのアーティファクトとして認識しておく必要があります。これを地下の微細な散乱体からの反射と誤認しないよう注意が必要です。

### 4.4 シミュレーションのための理論的差異の要約

本章での議論を、以下の比較表にまとめます。この表は、2Dと3Dの電磁波伝搬における主要な特性の違いを簡潔に示しています。

**表1：2Dと3Dにおける電磁波伝搬の主要特性の比較**

| 特性 | 3次元の場合（例：現実世界、3D FDTD） | 2次元の場合（例：2D FDTD） |
|------|----------------------------------|---------------------------|
| 波源モデル | 点波源 | 無限長線波源 |
| 波面の幾何学 | 球面 | 円筒 |
| グリーン関数 | $G_{3D} \propto e^{ikR}/R$ | $G_{2D} \propto H_0^{(1)}(k\rho)$ |
| 幾何学的拡散 | 強度 $\propto 1/R^2$ | 強度 $\propto 1/\rho$ |
| 遠方界での振幅減衰 | $E \propto 1/R$ | $E \propto 1/\sqrt{\rho}$ |
| 波形の尾引き | 無し（クリーンなインパルス応答） | 有り（持続的な後続波/リンギング） |
| 微分関係 | $E \propto dI/dt$（遠方界において） | $E \propto dI/dt$（遠方界において） |

この表からわかるように、「電場は電流の微分である」という遠方界での関係性は、次元によらず成り立ちます。この関係は、電場の放射成分がベクトルポテンシャルの時間微分に由来するという、両次元に共通の物理から生じるためです。しかし、その関係性を表現する波そのものの伝搬特性（振幅減衰、波形形状）は、2Dと3Dで根本的に異なります。

2Dシミュレーションは単に3D世界の一断面を切り取ったものではなく、異なる伝搬法則が支配する、物理的に別個の系を計算していると理解することが不可欠です。

## 第5章 gprMaxシミュレーションへの実践的含意

これまでの章で展開してきた抽象的な理論を、ユーザーが具体的に使用しているgprMaxシミュレーションのワークフローに結びつけます。本章では、理論的な概念がFDTDシミュレーション環境内でどのように現れるかを説明し、結果を解釈するための実践的な助言を提供します。

### 5.1 gprMaxのソース波形の解釈

gprMaxでは、#waveformコマンドを用いて、シミュレーションの電流源の時間波形を定義します。組み込み波形として、gaussian（ガウシアン波形）、gaussiandot（ガウシアン波形の1階微分）、そしてGPRシミュレーションで非常によく用いられるricker（リッカー波形）などがあります 33。

リッカー波形は、ガウシアン波形の負の2階微分として定義されています 35。

$$W_{ricker}(t) = - \left( 2\zeta (t-\chi)^2 -1 \right) e^{-\zeta(t-\chi)^2}$$

ここで、$\zeta$と$\chi$は中心周波数$f$によって決まるパラメータです。

これまでの理論的帰結、すなわち遠方界において$E \propto \frac{dI}{dt}$であるという事実を、これらの波形に適用してみましょう。これは、シミュレーション結果を予測し、理論を検証する強力な手段となります。

例えば、ユーザーが入力ファイルで電流源$I(t)$として`#waveform: ricker`を指定したとします。この場合、受信点で観測される遠方界の電場$E(t)$の波形は、リッカー波形の時間微分に比例するはずです。リッカー波形はガウシアンの負の2階微分なので、その時間微分はガウシアンの負の3階微分に比例する波形となります。

このように、入力する電流波形とその時間微分の形状を比較することで、シミュレーションが理論通りの結果を生成しているかを確認できます。逆に、特定の周波数スペクトルを持つ電場波形を生成したい場合、その波形を時間積分したものを電流源として入力するという設計も可能になります。

### 5.2 FDTD法がソースと観測場を数値的に結びつける仕組み

FDTD法は、第2章で述べたポテンシャルを用いた積分方程式を解くのではなく、マクスウェルの微分方程式（特に回転を伴うファラデーの法則とアンペール・マクスウェルの法則）を直接、空間と時間の両方で離散化して解く数値解析手法です 37。

シミュレーション空間は、Yeeセルとして知られる離散的なグリッドに分割されます。gprMaxの入力ファイルで指定された電流源（例えば、#hertzian_dipole）は、指定された位置のYeeセルにおいて、離散化されたアンペール・マクスウェルの法則の更新式に電流密度$\vec{J}$の項として直接加算されます。

シミュレーションは時間ステップごとに進行します。ある時間ステップで電流源によって磁場が更新されると、次の半ステップで、その更新された磁場が隣接するセルの電場を（離散化されたファラデーの法則に従って）変化させます。そして、その変化した電場がさらに次の半ステップで周囲の磁場を変化させる…というプロセスが連鎖的に繰り返されます。この時間ステップの繰り返しが、波源から外側へと電磁波が伝搬していく様子を数値的に再現しているのです。

FDTDアルゴリズムは、マクスウェル方程式が記述する物理現象の忠実な数値的模倣です。したがって、空間分解能が十分に高く、受信点が遠方界の条件を満たしていれば、これまでの章で導出した解析的な関係（遠方界での微分関係や2D/3Dの伝搬特性の違いなど）は、シミュレーション結果から自然に現れることになります。つまり、FDTDシミュレーションは、解析理論を検証するための数値実験と見なすことができます。

### 5.3 2D GPRシミュレーション結果の解釈に関する留意点

第4章で詳述した2Dと3Dの根本的な違いは、2Dシミュレーションの結果を解釈する際に常に念頭に置くべき重要な留意点をもたらします。

**振幅の解釈**: 2Dシミュレーションにおける電場振幅の減衰は$1/\sqrt{r}$則に従います。これは3Dの$1/r$則よりもはるかに緩やかです。したがって、2Dシミュレーションで得られた反射波の振幅からターゲットの反射率や媒質の減衰率を定量的に評価しようとする場合、この幾何学的拡散の違いを補正しないと、結果を過大評価する可能性があります。

**波形の尾引き（テイリング）の認識**: 2Dシミュレーションでは、伝搬に伴い波形にリンギングや尾引きが生じます。これは数値的な誤差ではなく、2D空間における波動伝搬の物理的な特性です。特に、深部のターゲットからの微弱な反射波を検出しようとする際に、この尾引き現象が先行する強い反射波（例えば地表面反射）の「クラッター」として現れ、目的の信号を覆い隠してしまう可能性があります。シミュレーション結果を解釈する際には、この尾引きが2Dモデル固有のアーティファクトであることを認識し、実際の地下構造からの反射と混同しないように注意する必要があります。

**2Dシミュレーションの適用範囲**: これらの特性から、2Dシミュレーションは、パイプラインやトレンチ、断層など、一つの方向に形状がほとんど変化しない「線状」のターゲットをモデル化する際には非常に有効で計算コストも低い選択肢です。しかし、点状のターゲット（例えば不発弾）や複雑な3次元構造からの散乱を正確に評価する必要がある場合には、計算コストは増大しますが、3Dシミュレーションが不可欠となります。

理論的な背景を深く理解することは、数値モデリングツールを「ブラックボックス」として使うのではなく、その能力と限界を把握した上で、より信頼性の高いシミュレーションを設計し、その結果を正しく解釈するための鍵となります。

## 第6章 結論と主要な所見

本報告書では、FDTDシミュレーションにおける入力電流波形と結果として得られる電場波形の数学的な関係について、電磁気学の基本原理に基づき詳細な解析を行いました。以下に、ご質問に対する主要な結論を要約します。

### 「電流波形を時間微分すると電場波形が得られる」という関係の妥当性

この関係は、遠方界近似が成り立つ条件下において正しいと結論付けられます。電場を生成する直接の物理的源は、波動方程式の強制項である電流密度の時間微分$\frac{\partial \vec{J}}{\partial t}$です。この基本的な関係は、波源から十分に離れた放射界において、電場$\vec{E}$が電流$I(t)$の時間微分$\frac{dI}{dt}$に直接比例するという明確な形で現れます。しかし、波源近傍の近傍界では、より複雑な項が支配的となり、この単純な微分関係は成立しません。

### 解析的な導出方法

電場波形を電流波形から解析的に導出する厳密な方法は、遅延ポテンシャルを用いるアプローチに基づきます。電流源から磁気ベクトルポテンシャル$\vec{A}$を計算し、電場を$\vec{E} = -\frac{\partial \vec{A}}{\partial t} - \nabla \phi$の関係式を用いて導出します。このプロセスに遠方界近似を適用することで、最終的に$\vec{E} \propto \frac{dI(t-r/c)}{dt}$という関係式が導かれます。

### 2次元と3次元の理論的な違い

理論には重大な違いが存在します。遠方界における$\vec{E} \propto \frac{dI}{dt}$という微分関係の形式自体は2Dと3Dで共通ですが、波動伝搬の物理法則が根本的に異なります。

**振幅減衰**: 3Dでは球面波として振幅が距離に反比例（$1/r$）して減衰するのに対し、2Dでは円筒波として距離の平方根に反比例（$1/\sqrt{r}$）して減衰します。

**波形形状**: 2Dシミュレーションでは、3Dの現実世界には存在しない「波形の尾引き（テイリング）」と呼ばれるアーティファクトが必然的に発生します。

これらの違いは、それぞれの次元における波動方程式の基本解（グリーン関数）の数学的な形式の違いに起因します。したがって、2Dシミュレーションは3D世界の単なる断面ではなく、異なる物理法則が支配する系として解釈する必要があります。

### gprMaxシミュレーションへの含意

FDTD法はマクスウェル方程式を忠実に数値化するため、本報告書で述べた理論的な関係はgprMaxのシミュレーション結果に直接反映されます。理論を理解することで、入力波形の選択から出力波形の予測、そして特に2Dシミュレーション結果の解釈（振幅の定量的評価やアーティファクトの認識）に至るまで、モデリングの精度と信頼性を大幅に向上させることが可能です。

総じて、強力な数値モデリングツールであるgprMaxを最大限に活用するためには、その背景にある電磁気学の理論的基盤を深く理解することが不可欠です。本報告書が、その一助となることを期待します。